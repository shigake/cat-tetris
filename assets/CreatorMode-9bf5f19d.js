import{u as W,r as i,d as ee,j as e,m as de,o as ue,a as me,p as xe,H as he,T as fe,N as be,t as pe,x as te,h as ge,P as Ge,i as we,S as ve,y as je}from"./index-21dd9244.js";const $=10,F=20,Z=["I","O","T","S","Z","J","L"],M={I:"#00f5ff",O:"#ffff00",T:"#a000f0",S:"#00f000",Z:"#f00000",J:"#0000f0",L:"#ff7f00",G:"#888888"},re=[{id:"tss",name:"T-Spin Single",emoji:"üéØ",desc:"O T-Spin mais simples ‚Äî limpa 1 linha",board:q(18,["GGG..GGGGG","GGG...GGGG"]),queue:["T"],isDefault:!0},{id:"tsd-right",name:"T-Spin Double (Direita)",emoji:"üåÄ",desc:"O cl√°ssico TSD ‚Äî limpa 2 linhas",board:q(17,["GGG..GGGGG","GGG...GGGG","GGGG.GGGGG"]),queue:["T"],isDefault:!0},{id:"tsd-left",name:"T-Spin Double (Esquerda)",emoji:"üåÄ",desc:"TSD espelhado ‚Äî limpa 2 linhas",board:q(17,["GGGGG..GGG","GGGG...GGG","GGGGG.GGGG"]),queue:["T"],isDefault:!0},{id:"tsd-chain",name:"TSD em Cadeia",emoji:"üîÅ",desc:"Dois T-Spin Doubles seguidos ‚Äî Back-to-Back!",board:q(12,["G....GGGGG","G...GGGGGG","GGG..GGGGG","GGG...GGGG","GGGG.GGGGG","GGG..GGGGG","GGG...GGGG","GGGG.GGGGG"]),queue:["T","T"],isDefault:!0},{id:"dt-cannon",name:"DT Cannon",emoji:"üí£",desc:"TSD + TST combinados!",board:q(13,["G...GGGGGG","G....GGGGG","GGGG.GGGGG","GGG..GGGGG","GGG...GGGG","GGGG.GGGGG","GGGG.GGGGG"]),queue:["T","T"],isDefault:!0},{id:"stsd",name:"Super T-Spin Double",emoji:"‚ö°",desc:"STSD ‚Äî usa wall kick avan√ßado pra entrar na cavidade!",board:q(13,["GGG..GGGGG","GGG..GGGGG","GGG..GGGGG","GGG...GGGG","GGGGG.GGGG","GGGG..GGGG","GGGG..GGGG"]),queue:["T","T"],isDefault:!0}];function q(t,o){const s=[];for(let n=0;n<F;n++)n>=t&&n<t+o.length?s.push(o[n-t]):s.push("..........");return s}function ye(t){return t.map(o=>Array.from(o).map(s=>s==="."||s===" "?null:{type:"G",color:M[s]||"#888",emoji:"‚¨ú"}))}function K(){return Array(F).fill(null).map(()=>Array($).fill(null))}function oe(t){return t.map(o=>o.map(s=>s?{...s}:null))}const Q="cattetris_all_setups";function se(t){return t.map(o=>o.map(s=>s?s.type||"G":".").join(""))}function Ne(t){return t.map(o=>Array.from(o).map(s=>s==="."?null:{type:s,color:M[s]||"#888",emoji:"‚¨ú"}))}function ne(t){return{id:t.id,name:t.name,emoji:t.emoji||"üé®",desc:t.desc||"",board:Array.isArray(t.board)&&typeof t.board[0]=="string"?t.board:se(t.board||[]),queue:t.queue||[],steps:t.steps||[],isDefault:t.isDefault||!1}}function ke(){try{const o=localStorage.getItem(Q);if(o){const s=JSON.parse(o);if(Array.isArray(s)&&s.length>0)return s}}catch{}const t=re.map(ne);return localStorage.setItem(Q,JSON.stringify(t)),t}function Ce(t){localStorage.setItem(Q,JSON.stringify(t))}function V(t){const o=JSON.stringify(t,null,2),s=new Blob([o],{type:"application/json"}),n=URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download="cat-tetris-setups.json",r.click(),URL.revokeObjectURL(n)}function Se(t){return new Promise((o,s)=>{const n=new FileReader;n.onload=r=>{try{const h=JSON.parse(r.target.result);if(!Array.isArray(h))throw new Error("not array");const l=h.filter(w=>w.name&&w.board&&Array.isArray(w.board)&&Array.isArray(w.queue));o(l.map(w=>({...w,id:w.id||"imp_"+Date.now()+"_"+Math.random().toString(36).slice(2,6)})))}catch(h){s(h)}},n.onerror=s,n.readAsText(t)})}function De(t,o){const s=new ge(new Ge,new we,null,new ve);s.initializeGame(),s.isPlaying=!0;for(let n=0;n<F;n++)for(let r=0;r<$;r++)t[n][r]&&s.board.setCell(r,n,t[n][r]);if(o.length>0){const n=r=>{const h=te[r],l=r==="I"?{x:3,y:-2}:{x:3,y:0};return new je(r,h.shape,h.color,h.emoji,l,!1,0)};for(s.currentPiece=n(o[0]),s.nextPieces=o.slice(1).map(n);s.nextPieces.length<3;)s.nextPieces.push(s.pieceFactory.createRandomPiece())}return s._markDirty(),s}function Re({onExit:t}){const{t:o}=W(),[s,n]=i.useState("menu"),[r,h]=i.useState(null),[l,w]=i.useState(()=>ke()),[d,v]=i.useState(null),[m,b]=i.useState(null),[g,x]=i.useState(K),[p,j]=i.useState([]),[P,f]=i.useState(""),[E,R]=i.useState("üé®"),[I,L]=i.useState(""),[O,u]=i.useState("G"),k=i.useRef(null),G=i.useCallback(c=>{w(c),Ce(c)},[]),y=i.useCallback(c=>{h(c),n("play")},[]),a=i.useCallback(()=>{h({id:"custom_preview",name:P||o("creator.customSetupName"),emoji:E,board:null,queue:[...p],_rawBoard:oe(g)}),n("play")},[g,p,P,E]),D=i.useCallback(()=>{v(null),x(K()),j([]),f(""),R("üé®"),L(""),n("editor")},[]),T=i.useCallback(c=>{v(c),x(Ne(c.board)),j([...c.queue]),f(c.name),R(c.emoji||"üé®"),L(c.desc||""),n("editor")},[]),N=i.useCallback(()=>{const c=P.trim()||o("creator.mySetup"),C=se(g);if(d){const S=l.map(A=>A.id===d.id?{...A,name:c,emoji:E,desc:I,board:C,queue:[...p]}:A);G(S)}else{const S={id:"custom_"+Date.now(),name:c,emoji:E,desc:I,board:C,queue:[...p],steps:[],isDefault:!1};G([...l,S])}n("menu")},[g,p,P,E,I,d,l,G]),H=i.useCallback(c=>{G(l.filter(C=>C.id!==c))},[l,G]),U=i.useCallback(()=>{const c=re.map(ne),C=l.filter(S=>!S.isDefault);G([...c,...C])},[l,G]),le=i.useCallback(async c=>{var S;const C=(S=c.target.files)==null?void 0:S[0];if(C){try{const A=await Se(C);if(A.length===0){b(o("creator.importNoValid"));return}G([...l,...A]),b(o("creator.importSuccess",{n:A.length})),setTimeout(()=>b(null),3e3)}catch{b(o("creator.importError")),setTimeout(()=>b(null),3e3)}c.target.value=""}},[l,G]),J=i.useCallback(()=>{l.length!==0&&V(l)},[l]),Y=i.useCallback((c,C)=>{const S=l.findIndex(ce=>ce.id===c);if(S<0)return;const A=S+C;if(A<0||A>=l.length)return;const B=[...l];[B[S],B[A]]=[B[A],B[S]],G(B)},[l,G]),z=5,ae=z+l.length,ie=i.useCallback(c=>{var C;switch(c){case 0:t();break;case 1:D();break;case 2:(C=k.current)==null||C.click();break;case 3:J();break;case 4:U();break;default:{const S=c-z;S>=0&&S<l.length&&y(l[S])}}},[t,D,J,U,l,y]),{selectedIndex:_}=ee({itemCount:ae,onConfirm:ie,onBack:t,active:s==="menu"});return s==="play"&&r?e.jsx(Ae,{template:r,onBack:()=>n("menu"),onExit:t}):s==="editor"?e.jsx(Ee,{board:g,setBoard:x,queue:p,setQueue:j,name:P,setName:f,emoji:E,setEmoji:R,desc:I,setDesc:L,selectedColor:O,setSelectedColor:u,onPlay:a,onSave:N,isEditing:!!d,onBack:()=>n("menu"),onExit:t}):e.jsxs("div",{className:"h-screen bg-gradient-to-b from-slate-900 via-indigo-950 to-slate-900 flex flex-col items-center p-4 overflow-auto",children:[e.jsxs("div",{className:"flex justify-between items-center w-full max-w-lg mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:o("creator.title")}),e.jsx("button",{onClick:t,className:`bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg text-sm font-bold ${_===0?"ring-2 ring-yellow-400":""}`,children:o("common.back")})]}),e.jsx("p",{className:"text-white/50 text-sm mb-4 text-center max-w-md",children:o("creator.subtitle")}),e.jsxs("div",{className:"flex gap-2 w-full max-w-lg mb-4 flex-wrap justify-center",children:[e.jsxs(de.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:D,className:`flex-1 min-w-[140px] p-3 rounded-xl bg-gradient-to-r from-violet-600/30 to-fuchsia-600/30 hover:from-violet-600/40 hover:to-fuchsia-600/40 border border-violet-500/30 hover:border-violet-500/50 transition-all flex items-center gap-3 ${_===1?"ring-2 ring-yellow-400":""}`,children:[e.jsx("span",{className:"text-2xl",children:"‚ûï"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-white font-bold text-sm",children:o("creator.createNew")}),e.jsx("div",{className:"text-white/40 text-[10px]",children:o("creator.createNewDesc")})]})]}),e.jsx("button",{onClick:()=>{var c;return(c=k.current)==null?void 0:c.click()},className:`bg-green-600/40 hover:bg-green-600/60 text-white px-4 py-3 rounded-xl text-xs font-bold transition-colors border border-green-500/20 ${_===2?"ring-2 ring-yellow-400":""}`,children:o("creator.import")}),e.jsx("button",{onClick:J,className:`bg-blue-600/40 hover:bg-blue-600/60 text-white px-4 py-3 rounded-xl text-xs font-bold transition-colors border border-blue-500/20 ${_===3?"ring-2 ring-yellow-400":""}`,disabled:l.length===0,children:o("creator.export")}),e.jsx("button",{onClick:U,className:`bg-orange-600/40 hover:bg-orange-600/60 text-white px-4 py-3 rounded-xl text-xs font-bold transition-colors border border-orange-500/20 ${_===4?"ring-2 ring-yellow-400":""}`,children:o("creator.resetDefaults")})]}),e.jsx("input",{ref:k,type:"file",accept:".json",onChange:le,className:"hidden"}),m&&e.jsx("div",{className:"w-full max-w-lg mb-3 px-4 py-2 rounded-lg bg-blue-500/20 border border-blue-500/30 text-blue-200 text-xs text-center font-medium",children:m}),e.jsxs("div",{className:"text-white/40 text-xs font-semibold uppercase tracking-wide mb-2",children:[o("creator.allSetups")," (",l.length,")"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 w-full max-w-lg pb-8",children:[l.map((c,C)=>e.jsx(Pe,{setup:c,onPlay:()=>y(c),onEdit:()=>T(c),onDelete:()=>H(c.id),onExport:()=>V([c]),onMoveUp:C>0?()=>Y(c.id,-1):null,onMoveDown:C<l.length-1?()=>Y(c.id,1):null,isHighlighted:_===z+C,t:o},c.id)),l.length===0&&e.jsx("div",{className:"text-center py-8 text-white/30 text-sm",children:o("creator.noSetups")})]})]})}function Pe({setup:t,onPlay:o,onEdit:s,onDelete:n,onExport:r,onMoveUp:h,onMoveDown:l,isHighlighted:w,t:d}){const[v,m]=i.useState(!1),b=t.isDefault;return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border transition-all ${b?"bg-white/[0.04] border-white/[0.06] hover:bg-white/[0.07]":"bg-violet-500/[0.06] border-violet-500/[0.12] hover:bg-violet-500/[0.1]"} ${w?"ring-2 ring-yellow-400":""}`,children:[e.jsx("div",{className:"flex flex-col items-center min-w-[44px]",children:e.jsx(Te,{boardRows:t.board})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-lg",children:t.emoji||"üé®"}),e.jsx("span",{className:"text-white font-bold text-sm truncate",children:t.name}),b&&e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-blue-500/20 text-blue-300 border border-blue-500/20 shrink-0",children:d("creator.defaultBadge")})]}),t.desc&&e.jsx("p",{className:"text-white/40 text-[11px] mt-0.5 leading-tight truncate",children:t.desc}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[e.jsx("span",{className:"text-white/30 text-[10px]",children:d("creator.pieces")}),(t.queue||[]).map((g,x)=>e.jsx("span",{className:"inline-block w-3.5 h-3.5 rounded",style:{backgroundColor:M[g]},title:g},x)),(!t.queue||t.queue.length===0)&&e.jsx("span",{className:"text-white/20 text-[10px]",children:d("creator.randomQueue")})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 shrink-0",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:o,className:"bg-emerald-600 hover:bg-emerald-500 text-white px-2.5 py-1 rounded text-[10px] font-bold transition-colors",title:d("creator.playTitle"),children:"üéÆ"}),e.jsx("button",{onClick:s,className:"bg-blue-600 hover:bg-blue-500 text-white px-2.5 py-1 rounded text-[10px] font-bold transition-colors",title:d("creator.editTitle"),children:"‚úèÔ∏è"}),e.jsx("button",{onClick:r,className:"bg-slate-600 hover:bg-slate-500 text-white px-2.5 py-1 rounded text-[10px] font-bold transition-colors",title:d("creator.exportTitle"),children:"üì§"})]}),e.jsxs("div",{className:"flex gap-1",children:[h&&e.jsx("button",{onClick:h,className:"bg-white/10 hover:bg-white/20 text-white px-2 py-1 rounded text-[10px] font-bold flex-1",title:d("creator.moveUp"),children:"‚ñ≤"}),l&&e.jsx("button",{onClick:l,className:"bg-white/10 hover:bg-white/20 text-white px-2 py-1 rounded text-[10px] font-bold flex-1",title:d("creator.moveDown"),children:"‚ñº"})]}),v?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{n(),m(!1)},className:"bg-red-600 hover:bg-red-500 text-white px-2 py-1 rounded text-[9px] font-bold flex-1",children:d("common.yes")}),e.jsx("button",{onClick:()=>m(!1),className:"bg-slate-600 hover:bg-slate-500 text-white px-2 py-1 rounded text-[9px] font-bold flex-1",children:d("common.no")})]}):e.jsx("button",{onClick:()=>m(!0),className:"bg-red-700/40 hover:bg-red-700/70 text-red-300 px-2.5 py-1 rounded text-[10px] font-bold transition-colors w-full",children:d("creator.delete")})]})]})}function Te({boardRows:t}){const s=t.findIndex(r=>r!==".........."),n=t.slice(Math.max(s>=0?s:F-4,F-6));return e.jsx("div",{className:"bg-black/40 rounded border border-white/10 p-0.5",children:n.map((r,h)=>e.jsx("div",{className:"flex",children:Array.from(r).map((l,w)=>e.jsx("div",{style:{width:3,height:3,backgroundColor:l!=="."?"#888":"transparent"}},w))},h))})}function Ae({template:t,onBack:o,onExit:s}){var f,E,R,I,L,O,u,k,G,y;const{t:n}=W(),[r,h]=i.useState(null),[l,w]=i.useState(0),d=i.useRef(null),v=i.useRef(null),m=i.useRef(0),b=i.useMemo(()=>t._rawBoard?oe(t._rawBoard):ye(t.board),[t]),g=i.useCallback(()=>{v.current&&cancelAnimationFrame(v.current);const a=De(b,t.queue);d.current=a,h(a.getGameState()),m.current=0,w(D=>D+1)},[b,t.queue]);i.useEffect(()=>{g()},[g]),i.useEffect(()=>{const a=D=>{m.current||(m.current=D);const T=D-m.current;m.current=D;const N=d.current;N&&(!N.gameOver&&!N.isPaused&&N.updateGame(T),N.isDirty&&(h(N.getGameState()),N.clearDirty()),v.current=requestAnimationFrame(a))};return v.current=requestAnimationFrame(a),()=>{v.current&&cancelAnimationFrame(v.current)}},[l]),i.useEffect(()=>{const a=ue(me()),D=T=>{const N=d.current;if(!N||N.gameOver)return;const H=a[T.key];if(T.key==="r"||T.key==="R"){g();return}if(H)switch(H){case"moveLeft":T.preventDefault(),N.movePiece("left");break;case"moveRight":T.preventDefault(),N.movePiece("right");break;case"moveDown":T.preventDefault(),N.movePiece("down");break;case"rotate":T.preventDefault(),N.rotatePiece();break;case"rotateLeft":N.rotatePieceLeft();break;case"hold":N.holdPiece();break;case"hardDrop":T.preventDefault(),N.hardDrop();break}};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[g]);const x=i.useMemo(()=>({movePiece:a=>{const D=d.current;D&&!D.gameOver&&D.movePiece(a)},rotatePiece:()=>{const a=d.current;a&&!a.gameOver&&a.rotatePiece()},rotatePieceLeft:()=>{const a=d.current;a&&!a.gameOver&&a.rotatePieceLeft()},hardDrop:()=>{const a=d.current;a&&!a.gameOver&&a.hardDrop()},holdPiece:()=>{const a=d.current;a&&!a.gameOver&&a.holdPiece()},isGameOver:()=>{var a;return((a=d.current)==null?void 0:a.gameOver)??!1},backToMenu:s,togglePause:()=>{}}),[s]),{isGamepadActive:p,processGamepadInput:j}=xe(x);i.useEffect(()=>{if(!p)return;const a=setInterval(()=>j(),16);return()=>clearInterval(a)},[p,j]);const P=i.useMemo(()=>{var a;if(!(r!=null&&r.currentPiece)||r!=null&&r.gameOver)return null;try{return(a=d.current)==null?void 0:a.getDropPreview()}catch{return null}},[(E=(f=r==null?void 0:r.currentPiece)==null?void 0:f.position)==null?void 0:E.x,(I=(R=r==null?void 0:r.currentPiece)==null?void 0:R.position)==null?void 0:I.y,(L=r==null?void 0:r.currentPiece)==null?void 0:L.type,(O=r==null?void 0:r.currentPiece)==null?void 0:O.rotationState]);return e.jsxs("div",{className:"h-screen bg-gradient-to-b from-slate-900 via-indigo-950 to-slate-900 flex flex-col items-center p-2 overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center w-full max-w-xl mb-2",children:[e.jsxs("h1",{className:"text-lg font-bold text-white truncate",children:[t.emoji," ",t.name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:g,className:"bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded-lg text-xs font-bold",children:n("creator.replay")}),e.jsx("button",{onClick:o,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-xs font-bold",children:n("common.back")}),e.jsx("button",{onClick:s,className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-xs font-bold",children:n("common.exit")})]})]}),r&&e.jsxs("div",{className:"flex gap-3 items-start justify-center",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(he,{heldPiece:r.heldPiece,canHold:r.canHold}),e.jsx("div",{className:"text-white/50 text-[10px] leading-tight",dangerouslySetInnerHTML:{__html:n("creator.playControls").replace(/  /g,"<br/>")}})]}),e.jsx(fe,{board:r.board,currentPiece:r.currentPiece,dropPreview:P,gameOver:r.gameOver}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(be,{pieces:r.nextPieces||[]}),e.jsx(pe,{score:((u=r.score)==null?void 0:u.points)||0,level:((k=r.score)==null?void 0:k.level)||1,lines:((G=r.score)==null?void 0:G.lines)||0,combo:((y=r.score)==null?void 0:y.combo)||0})]})]}),(r==null?void 0:r.gameOver)&&e.jsxs("div",{className:"mt-4 flex gap-3",children:[e.jsx("button",{onClick:g,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-bold text-lg",children:n("creator.tryAgain")}),e.jsx("button",{onClick:o,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-bold text-lg",children:n("common.back")})]})]})}function Ee({board:t,setBoard:o,queue:s,setQueue:n,name:r,setName:h,emoji:l,setEmoji:w,desc:d,setDesc:v,selectedColor:m,setSelectedColor:b,onPlay:g,onSave:x,isEditing:p,onBack:j,onExit:P}){const{t:f}=W(),E=i.useCallback((u,k)=>{o(G=>{const y=G.map(a=>[...a]);return y[k][u]=y[k][u]?null:{type:m,color:M[m],emoji:"‚¨ú"},y})},[m,o]),R=i.useCallback((u,k)=>{o(G=>{const y=G.map(a=>[...a]);for(let a=0;a<$;a++)y[u][a]=a===k?null:{type:"G",color:M.G,emoji:"‚¨ú"};return y})},[o]),I=i.useCallback(u=>{o(k=>{const G=k.map(y=>[...y]);for(let y=0;y<$;y++)G[u][y]=null;return G})},[o]),L=i.useCallback(u=>{switch(u){case 0:j();break;case 1:P();break;case 2:x();break;case 3:g();break}},[j,P,x,g]),{selectedIndex:O}=ee({itemCount:4,onConfirm:L,onBack:j,active:!0});return e.jsxs("div",{className:"h-screen bg-gradient-to-b from-slate-900 via-indigo-950 to-slate-900 flex flex-col items-center p-3 overflow-auto",children:[e.jsxs("div",{className:"flex justify-between items-center w-full max-w-2xl mb-3",children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:f(p?"creator.editSetup":"creator.createMySetup")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:j,className:`bg-slate-600 hover:bg-slate-700 text-white px-3 py-1 rounded-lg text-sm font-bold ${O===0?"ring-2 ring-yellow-400":""}`,children:f("common.back")}),e.jsx("button",{onClick:P,className:`bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-sm font-bold ${O===1?"ring-2 ring-yellow-400":""}`,children:f("common.exit")})]})]}),e.jsxs("div",{className:"flex gap-4 items-start justify-center flex-wrap max-w-2xl",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-white/60 text-xs font-semibold mb-1",children:f("creator.boardLabel")}),e.jsx(Ie,{board:t,onToggle:E,onFillRow:R,onClearRow:I,t:f}),e.jsxs("div",{className:"flex gap-1 items-center mt-1",children:[e.jsx("span",{className:"text-white/50 text-xs mr-1",children:f("creator.color")}),Z.map(u=>e.jsx("button",{onClick:()=>b(u),className:`w-6 h-6 rounded border-2 transition-all ${m===u?"border-white scale-110":"border-white/20"}`,style:{backgroundColor:M[u]},title:u},u)),e.jsx("button",{onClick:()=>b("G"),className:`w-6 h-6 rounded border-2 transition-all ${m==="G"?"border-white scale-110":"border-white/20"}`,style:{backgroundColor:M.G},title:f("creator.gray")})]}),e.jsx("button",{onClick:()=>o(K()),className:"bg-red-700/60 hover:bg-red-700 text-white px-3 py-1 rounded text-xs font-semibold mt-1 w-fit",children:f("creator.clearAll")})]}),e.jsxs("div",{className:"flex flex-col gap-3 min-w-[160px]",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-white/60 text-xs font-semibold mb-2",children:f("creator.queueLabel")}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:Z.map(u=>e.jsx("button",{onClick:()=>n(k=>[...k,u]),className:"flex items-center justify-center w-9 h-9 rounded-lg bg-white/10 hover:bg-white/20 border border-white/10 transition-all",title:f("creator.addPiece",{piece:u}),children:e.jsx(X,{type:u})},u))}),e.jsxs("div",{className:"flex flex-col gap-1 min-h-[60px] bg-black/30 rounded-lg p-2",children:[s.length===0?e.jsx("span",{className:"text-white/30 text-xs text-center py-2",dangerouslySetInnerHTML:{__html:f("creator.queueEmpty").replace(`
`,"<br/>")}}):e.jsx("div",{className:"flex flex-wrap gap-1",children:s.map((u,k)=>e.jsxs("button",{onClick:()=>n(G=>G.filter((y,a)=>a!==k)),className:"flex items-center justify-center w-8 h-8 rounded bg-white/10 hover:bg-red-500/30 border border-white/10 transition-all group relative",title:f("creator.removeTitle"),children:[e.jsx(X,{type:u,size:10}),e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-[8px] rounded-full w-3 h-3 flex items-center justify-center opacity-0 group-hover:opacity-100",children:"√ó"})]},k))}),s.length>0&&e.jsx("button",{onClick:()=>n([]),className:"text-red-400 text-[10px] mt-1 hover:text-red-300",children:f("creator.clearQueue")})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white/60 text-xs font-semibold mb-2",children:f("creator.detailsLabel")}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:l,onChange:u=>w(u.target.value),placeholder:"üé®",maxLength:4,className:"w-14 px-2 py-2 rounded-lg bg-black/30 border border-white/10 text-white text-center text-lg focus:border-violet-500/50 focus:outline-none",title:"Emoji"}),e.jsx("input",{type:"text",value:r,onChange:u=>h(u.target.value),placeholder:f("creator.namePlaceholder"),maxLength:40,className:"flex-1 px-3 py-2 rounded-lg bg-black/30 border border-white/10 text-white text-sm placeholder-white/20 focus:border-violet-500/50 focus:outline-none"})]}),e.jsx("input",{type:"text",value:d,onChange:u=>v(u.target.value),placeholder:f("creator.descPlaceholder"),maxLength:80,className:"w-full px-3 py-2 rounded-lg bg-black/30 border border-white/10 text-white text-xs placeholder-white/20 focus:border-violet-500/50 focus:outline-none mb-3"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:x,className:`w-full py-3 rounded-xl bg-gradient-to-r from-violet-500 to-purple-500 hover:from-violet-400 hover:to-purple-400 text-white font-bold text-base shadow-lg shadow-violet-500/25 transition-all active:scale-95 ${O===2?"ring-2 ring-yellow-400":""}`,children:f(p?"creator.saveChanges":"creator.saveSetup")}),e.jsx("button",{onClick:g,className:`w-full py-2.5 rounded-xl bg-gradient-to-r from-emerald-500 to-green-500 hover:from-emerald-400 hover:to-green-400 text-white font-bold text-sm shadow-lg shadow-emerald-500/25 transition-all active:scale-95 ${O===3?"ring-2 ring-yellow-400":""}`,children:f("creator.testWithoutSaving")})]})]})]})]})}function Ie({board:t,onToggle:o,onFillRow:s,onClearRow:n,t:r}){const[h,l]=i.useState(!1),[w,d]=i.useState(null),v=22,m=(x,p)=>{l(!0),d(t[p][x]?"erase":"place"),o(x,p)},b=(x,p)=>{h&&(w==="place"&&!t[p][x]&&o(x,p),w==="erase"&&t[p][x]&&o(x,p))},g=()=>{l(!1),d(null)};return i.useEffect(()=>(window.addEventListener("pointerup",g),()=>window.removeEventListener("pointerup",g)),[]),e.jsx("div",{className:"relative bg-black/50 rounded-lg border border-white/10 select-none",style:{width:v*$+2,padding:1},onContextMenu:x=>x.preventDefault(),children:t.map((x,p)=>e.jsxs("div",{className:"flex",style:{height:v},children:[x.map((j,P)=>e.jsx("div",{onPointerDown:()=>m(P,p),onPointerEnter:()=>b(P,p),className:"cursor-pointer border border-white/[0.04] hover:border-white/20 transition-colors",style:{width:v,height:v,backgroundColor:j?j.color:"transparent",opacity:j?.85:1}},P)),e.jsx("button",{onClick:()=>x.some(j=>j)?n(p):s(p,Math.floor(Math.random()*$)),className:"ml-0.5 text-white/20 hover:text-white/60 text-[9px] w-4 flex items-center justify-center",title:x.some(j=>j)?r("creator.clearLine"):r("creator.fillLine"),children:x.some(j=>j)?"√ó":"+"})]},p))})}function X({type:t,size:o=12}){var v;const s=(v=te[t])==null?void 0:v.shape;if(!s)return null;const n=M[t],r=s.filter(m=>m.some(b=>b));let h=1/0,l=-1;for(const m of r)for(let b=0;b<m.length;b++)m[b]&&(h=Math.min(h,b),l=Math.max(l,b));if(l<0)return null;const w=r.map(m=>m.slice(h,l+1)),d=l-h+1;return e.jsx("div",{className:"flex flex-col items-center",children:w.map((m,b)=>e.jsx("div",{className:"flex",children:Array.from({length:d},(g,x)=>e.jsx("div",{style:{width:o,height:o,backgroundColor:m[x]?n:"transparent",borderRadius:1}},x))},b))})}export{Re as default};
